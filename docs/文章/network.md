# 计算机网络面试题

## 输入网址后发生了什么？

应用层 DNA 解析，传输层 TCP 连接，网络层 IP，数据链路 MAC，真实物理层，接收到之后再一层层扒皮。

## DNS 解析的具体过程

DNS 域名解析就是把域名翻译成 ip 地址的过程，例如将 www.baidu.com 翻译成 1.2.3.4 这个 IP，总共分为以下步骤：

- 浏览器缓存检查：浏览器首先会检查自身 DNS 缓存，这个缓存只能容纳 1000 条，且缓存时间比较短，只有一分钟。如果没有查到缓存，则进行下一步
- 操作系统缓存检查 + hosts 解析：如果浏览器缓存没有查到，则会查找操作系统缓存的解析结果。Linux 可以通过 /etc/hosts 文件来设置域名对应的 ip，如果在这个文件查到了域名，会优先访问这里配置的 ip，并将这个结果缓存起来。缓存时间受域名失效时间和缓存大小控制的
- dns 解析 1：客户端通过浏览器访问域名为 www.baidu.com 的网站，发起查询该域名 ip 的 dns 请求。该请求发送到本地 dns 服务器，本地 dns 服务区首先会检查自己的缓存记录，如果缓存中有此记录，就可以直接返回结果，否则本地 dns 服务器向根服务器发起请求
- dns 解析 2：本地 dns 服务器向根服务器发送 dns 请求，请求域名为 www.baidu.com 的 ip 地址
- dns 解析 3：根服务器经过查询，没有找到该域名及 ip 的对应关系，告诉本地 dns 服务器，可以到 .com 域名服务器上继续查询
- dns 解析 4：本地 dns 服务器向 .com 服务器发送 dns 请求，请求域名为 www.baidu.com 的 ip 地址
- dns 解析 5：.com 服务器接收到请求后，不会立即返回对应 ip，而是告诉本地 dns 服务器，可以在 baidu.com 的域名服务器上请求获取 ip 地址
- dns 解析 6：本地 dns 服务器向 baidu.com 服务器发送 dns 请求，请求域名为 www.baidu.com 的 ip 地址
- dns 解析 7：baidu.com 服务器在自己的缓存表中发现了该域名和 ip 地址的对应关系，并将 ip 地址返回给本地 dns 服务器
- dns 解析 8：本地 dns 服务器将获取到域名与对应的 ip 地址返回给客户端，并将结果缓存供下次查询

## TCP 拆包沾包的原因

- TCP 协议是基于字节流的传输协议，没有固定的分包边界。发送方将数据拆分成多个小的数据包进行传输，接收方再将这些数据包组合成完整的数据。在这个过程中可能会出现拆包和沾包现象
- 网络传输中的延迟和拥塞会影响数据包发送的速度和到达接收方的顺序，可能导致数据包的拆分和组合不规律
- 接收方缓冲区大小限制。当接收方缓冲区大小小于完整数据包大小，可能会发生拆包

解决方式：

- 在应用层实现数据包的边界识别，添加包头，包头中添加数据长度等信息
- 使用固定长度的数据包或特殊的分隔符，便于数据包识别边界
- 使用更高级的传输层协议，如 WebSocket，它在 TCP 的基础上添加了数据帧的概念，可以更好地解决拆包和沾包问题

## 对称加密和非对称加密的区别？

- 对称加密是双方使用同一个密钥加解密，优点是运算速度快，缺点是安全性不高，一旦密钥泄露则有风险
- 非对称加密的安全性高，但计算速度低，一般非对称加密用在验证证书阶段，对称加密用在数据传输阶段，非对称加密的基本路程如下[1]：
	- 假设爱丽丝和鲍勃事先互不认识，也没有可靠安全的沟通通道，爱丽丝现在要通过不安全的互联网向鲍勃发送消息
	- 爱丽丝写好原文，设为 x
	- 鲍勃使用密码学安全伪随机数生成一对密钥，一个作为公钥 c，一个作为私钥 d
	- 鲍勃将公钥 c 通过不安全的互联网发送给爱丽丝，即使窃听者伊夫在中间窃听到 c 也没问题
	- 爱丽丝用公钥 c 对原文加密，得到密文 c(x)
	- 爱丽丝可以用任何方法传输密文 c(x) 给鲍勃，即使窃听者伊夫在中间窃听到 c(x) 也没问题
	- 鲍勃收到密文 f(x)，用私钥 d 对 c(x) 进行解密，即 d(c(x))，得到原始明文 x
	- 由于伊夫没有得到私钥 d，所以无法获取明文 x
	- 如果爱丽丝丢失了原文 x，在没有得到鲍勃的私钥 d 的情况下，她和伊夫一样无法通过鲍勃的公钥 c 和密文 c(x) 重新得到原文 x

## 有哪些对称加密和非对称加密的算法？

- 对称加密：
	- AES：最流行和广泛使用的算法之一，支持不同的密钥长度。如 AES-128，AES-256
- 非对称加密算法：
	- RSA：最常见的非对称加密算法，用于数据加密和数字签名
	- ECC：基于椭圆曲线的非对称加密算法，具有较高的安全性和效率，使用于移动设备等资源受限的环境

## 在信息传输过程中，HTTPS用的是对称加密还是非对称加密

HTTPS 使用的混合加密方式，对称加密和非对称加密都有。

- 在通信建立前采用非对称加密的方式交换会话密钥，后续就不再使用非对称加密
- 在通信过程中使用对称加密的会话密钥方式加密会话数据

## HTTPS 四次握手过程说一下

SSL/TLS 协议的基本流程：

- 客户端向服务端索要并验证服务器的公钥
- 双方协商生成会话密钥
- 双方使用会话密钥进行加密通信

前两步即 SSL 建立握手的阶段。TLS 协议建立的详细流程：

1. ClientHello

客户端收到服务器的回应之后，首先通过浏览器或者操作系统中的 CA 公钥，确认服务器的数字的真实性。

如果证书没有问题。

2. ServerHello

3. 客户端回应

4. 服务端回应

## 参考文章

1. 公开密钥加密：https://zh.wikipedia.org/wiki/%E5%85%AC%E5%BC%80%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86
